import { useContext } from 'react';
import { AppContext } from '@/contexts/AppContext';

export const translations = {
  en: {
    'app.title': 'RentalFlow Manager',
    'nav.dashboard': 'Dashboard',
    'nav.tenants': 'Tenants',
    'nav.invoices': 'Invoices',
    'nav.expenses': 'Expenses',
    'nav.properties': 'Properties',
    'role.owner': 'Owner',
    'role.tenant': 'Tenant',
    'status.paid': 'PAID',
    'status.due': 'DUE',
    'status.pending': 'PENDING',
    'debt.outstanding': 'Outstanding Debt',
    'action.submit_payment': 'Submit Payment',
    'action.mark_paid': 'Mark as PAID',
    'action.reject_payment': 'Reject Payment',
    'action.generate_invoices': 'Generate Missing Invoices',
    'action.add_tenant': 'Add Tenant',
    'action.edit_tenant': 'Edit Tenant',
    'action.add_expense': 'Add Expense',
    'action.save': 'Save',
    'action.cancel': 'Cancel',
    'form.month': 'Month',
    'form.year': 'Year',
    'form.name': 'Name',
    'form.contact': 'Contact (Email/Phone)',
    'form.property': 'Property',
    'form.rent': 'Fixed Monthly Rent',
    'form.pays_utilities': 'Pays Utilities',
    'form.amount': 'Amount',
    'form.description': 'Description',
    'form.date': 'Date',
    'form.type': 'Type',
    'form.select_invoices': 'Select invoices to pay',
    'form.payment_amount': 'Payment Amount',
    'form.payment_receipt': 'Payment Receipt',
    'form.upload_receipt': 'Upload Receipt',
    'form.select_month': 'Select Month',
    'form.select_year': 'Select Year',
    'form.select_property': 'Select a property',
    'form.select_type': 'Select a type',
    'report.total_income': 'Total Income',
    'report.total_expenses': 'Total Expenses',
    'report.total_savings': 'Total Savings',
    'report.cash_flow': 'Cash Flow Report',
    'report.income_summary': 'Income Summary',
    'report.collected': 'Collected',
    'report.outstanding': 'Outstanding',
    'notifications.title': 'Notifications',
    'notifications.unverified_payments': 'Unverified Payments',
    'notifications.view': 'View',
    'tenant.current_invoices': 'Current & Past Invoices',
    'tenant.no_invoices': 'No invoices to display.',
    'tenant.debt_notifications_active': 'Daily debt notifications are active.',
    'tenant.select_tenancy': 'Select Tenancy',
    'tenant.property_details': 'Property Details',
    'table.header.tenant': 'Tenant',
    'table.header.property': 'Property',
    'table.header.month': 'Month',
    'table.header.total_due': 'Total Due',
    'table.header.status': 'Status',
    'table.header.actions': 'Actions',
    'table.header.description': 'Description',
    'table.header.amount': 'Amount',
    'table.header.date': 'Date',
    'table.header.address': 'Address',
    'verification.title': 'Payment Verification',
    'verification.details': 'Invoice Details',
    'verification.submitted_amount': 'Submitted Amount',
    'verification.receipt': 'Payment Receipt',
    'verification.verify_ai': 'Verify with AI',
    'verification.result': 'AI Verification Result',
    'verification.accurate': 'Accurate',
    'verification.not_accurate': 'Not Accurate',
    'verification.extracted_amount': 'Extracted Amount',
    'verification.notes': 'Notes',
    'verification.success': 'Payment verified and marked as PAID.',
    'verification.rejected': 'Payment rejected. Tenant will be notified.',
    'verification.error': 'AI verification failed. Please try again.',
    'invoice_generator.title': 'Generate Missing Invoices',
    'invoice_generator.description': 'This will check all tenants and create any missing invoices from their start date until the current month.',
    'invoice_generator.success': 'Invoice check complete.',
    'validation.name.required': 'Tenant name is required',
    'validation.email.invalid': 'Email must be a valid email',
    'validation.phone.invalid': 'Phone must include country code (e.g. +1...)',
    'validation.rent.negative': 'Rent cannot be a negative number',
    'validation.startDate.required': 'Start date is required',
    'validation.propertyId.required': 'Property is required',
    'validation.description.required': 'Description is required',
    'validation.amount.negative': 'Amount cannot be negative',
    'validation.type.required': 'Type is required',
    'validation.date.required': 'Date is required',
    'expense_type.water': 'Water',
    'expense_type.electricity': 'Electricity',
    'expense_type.gas': 'Gas',
    'expense_type.taxes': 'Taxes',
    'expense_type.phone': 'Phone',
    'expense_type.other_services': 'Other Services',
  },
  es: {
    'app.title': 'RentalFlow Manager',
    'nav.dashboard': 'Panel de Control',
    'nav.tenants': 'Inquilinos',
    'nav.invoices': 'Facturas',
    'nav.expenses': 'Gastos',
    'nav.properties': 'Propiedades',
    'role.owner': 'Propietario',
    'role.tenant': 'Inquilino',
    'status.paid': 'PAGADO',
    'status.due': 'DEUDA',
    'status.pending': 'PENDIENTE',
    'debt.outstanding': 'Deuda Pendiente',
    'action.submit_payment': 'Enviar Pago',
    'action.mark_paid': 'Marcar como PAGADO',
    'action.reject_payment': 'Rechazar Pago',
    'action.generate_invoices': 'Generar Facturas Faltantes',
    'action.add_tenant': 'Añadir Inquilino',
    'action.edit_tenant': 'Editar Inquilino',
    'action.add_expense': 'Añadir Gasto',
    'action.save': 'Guardar',
    'action.cancel': 'Cancelar',
    'form.month': 'Mes',
    'form.year': 'Año',
    'form.name': 'Nombre',
    'form.contact': 'Contacto (Email/Teléfono)',
    'form.property': 'Propiedad',
    'form.rent': 'Renta Mensual Fija',
    'form.pays_utilities': 'Paga Servicios Públicos',
    'form.amount': 'Monto',
    'form.description': 'Descripción',
    'form.date': 'Fecha',
    'form.type': 'Tipo',
    'form.select_invoices': 'Seleccionar facturas a pagar',
    'form.payment_amount': 'Monto del Pago',
    'form.payment_receipt': 'Recibo de Pago',
    'form.upload_receipt': 'Subir Recibo',
    'form.select_month': 'Seleccionar Mes',
    'form.select_year': 'Seleccionar Año',
    'form.select_property': 'Seleccionar una propiedad',
    'form.select_type': 'Seleccionar un tipo',
    'report.total_income': 'Ingresos Totales',
    'report.total_expenses': 'Gastos Totales',
    'report.total_savings': 'Ahorro Total',
    'report.cash_flow': 'Reporte de Flujo de Caja',
    'report.income_summary': 'Resumen de Ingresos',
    'report.collected': 'Recaudado',
    'report.outstanding': 'Pendiente',
    'notifications.title': 'Notificaciones',
    'notifications.unverified_payments': 'Pagos no Verificados',
    'notifications.view': 'Ver',
    'tenant.current_invoices': 'Facturas Actuales y Pasadas',
    'tenant.no_invoices': 'No hay facturas para mostrar.',
    'tenant.debt_notifications_active': 'Las notificaciones diarias de deuda están activas.',
    'tenant.select_tenancy': 'Seleccionar Inquilinato',
    'tenant.property_details': 'Detalles de la Propiedad',
    'table.header.tenant': 'Inquilino',
    'table.header.property': 'Propiedad',
    'table.header.month': 'Mes',
    'table.header.total_due': 'Total a Pagar',
    'table.header.status': 'Estado',
    'table.header.actions': 'Acciones',
    'table.header.description': 'Descripción',
    'table.header.amount': 'Monto',
    'table.header.date': 'Fecha',
    'table.header.address': 'Dirección',
    'verification.title': 'Verificación de Pago',
    'verification.details': 'Detalles de la Factura',
    'verification.submitted_amount': 'Monto Enviado',
    'verification.receipt': 'Recibo de Pago',
    'verification.verify_ai': 'Verificar con IA',
    'verification.result': 'Resultado de Verificación IA',
    'verification.accurate': 'Preciso',
    'verification.not_accurate': 'No Preciso',
    'verification.extracted_amount': 'Monto Extraído',
    'verification.notes': 'Notas',
    'verification.success': 'Pago verificado y marcado como PAGADO.',
    'verification.rejected': 'Pago rechazado. Se notificará al inquilino.',
    'verification.error': 'La verificación con IA falló. Por favor, intente de nuevo.',
    'invoice_generator.title': 'Generar Facturas Faltantes',
    'invoice_generator.description': 'Esto revisará a todos los inquilinos y creará las facturas faltantes desde su fecha de inicio hasta el mes actual.',
    'invoice_generator.success': 'Revisión de facturas completada.',
    'validation.name.required': 'El nombre del inquilino es requerido',
    'validation.email.invalid': 'El email debe ser válido',
    'validation.phone.invalid': 'El teléfono debe incluir el código de país (ej. +1...)',
    'validation.rent.negative': 'La renta no debe ser un número negativo',
    'validation.startDate.required': 'La fecha de inicio es requerida',
    'validation.propertyId.required': 'La propiedad es requerida',
    'validation.description.required': 'La descripción es requerida',
    'validation.amount.negative': 'El monto no puede ser negativo',
    'validation.type.required': 'El tipo es requerido',
    'validation.date.required': 'La fecha es requerida',
    'expense_type.water': 'Agua',
    'expense_type.electricity': 'Luz',
    'expense_type.gas': 'Gas',
    'expense_type.taxes': 'Impuestos',
    'expense_type.phone': 'Teléfono',
    'expense_type.other_services': 'Otros Servicios',
  },
};

export type TranslationKey = keyof (typeof translations)['en'];

export function useTranslation() {
  const context = useContext(AppContext);
  if (!context) {
    throw new Error('useTranslation must be used within an AppProvider');
  }
  const { language } = context;

  return (key: TranslationKey, ...args: any[]) => {
    let translation = translations[language][key] || key;
    if (args.length > 0) {
      translation = translation.replace(/{(\d+)}/g, (match, number) => {
        return typeof args[number] !== 'undefined' ? args[number] : match;
      });
    }
    return translation;
  };
}
